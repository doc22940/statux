# Statux [![npm install statux](https://img.shields.io/badge/npm%20install-statux-blue.svg)](https://www.npmjs.com/package/statux) [![gzip size](https://img.badgesize.io/franciscop/statux/master/index.min.js.svg?compression=gzip)](https://github.com/franciscop/statux/blob/master/index.min.js)

A React state management store with hooks:

```js
import Store, { useStore } from  'statux';

// App.js
export default () => {
  <Store user={false}>
    ...
  </Store>
};

// User.js
export default () => {
  // setUser(newUser) is autogenerated because there's a 'user' state key
  const { user, setUser } = useStore();
  return <div>{user.name}</div>;
};
```

## Getting started

First create a React project (we recommend using [Create-React-App](https://github.com/facebook/create-react-app) for this). Then install `statux`:

```
npm install statux
```

Now we are going to initialize our store at the App root level with the default values:

```js
// src/App.js
import React from 'react';
import Store from 'statux'; // This library
import Navigation from './Navigation'; // Your code

export default () => (
  <Store user={false} books={[]} {...}>
    <Navigation />
  </Store>
);
```

Finally, use and update these values wherever you want with `useStore()` or `State`:

```js
// src/pages/User.js
import React from 'react';
import { useStore } from 'statux';

export default () => {
  const { user, setUser } = useStore();
  return (
    <div>
      Hello  {user || <button onClick={e => setUser('Maria')}>Login</button>}
    </div>
  )
};
```


## API

There are 4 exports; a default one, and three named ones:

```js
import Store, { useStore, useSelector, useActions, State } from 'statux';
```

- **`Store`**: the main wrapper, every other component should be used within the tree of this.
- **`useStore()`**: the main way of extracting data, it will return the state along with the setters.
- **`useSelector()`**: accepts a selector that will receive the current state and return a single value.
- **`State`**: a convenient Render Prop that allows you to extract simple state inline.
- **`useActions()`**: some default actions that you can use straight away to simplify your code and avoid mutations.

```js
import Store, { useStore, State, useActions } from 'statux';

const { user, setUser, books, setBooks } = useStore();
<State>{({ user, books }) => (...)}</State>
const { append, prepend, increment, ...actions } = useActions('books');
```


## Example - Pokemon Website

In this example we are going to build a fully working pokedex! It will show a list of pokemon, and whether the user has captured them or not. It will include authentication and asynchronously loading the data.

We are going to see each section individually, but first let's see the base of our App:

```js
// src/App.js
export default () => (
  <Store user={false} pokemon={false}>
    <Router>
      <Switch>
        <Route exact to="/" component={PokemonList} />
        <Route exact to="/login" component={Auth} />
        <Route exact to="/user" component={User} />
        <Route exact to="/:id" component={Pokemon} />
      </Switch>
    </Router>
  </Store>
);
```

### Auth

How to authenticate the user with an API that returns a user:

```js
// src/Auth.js
import { useStore } from 'statux';
import axios from 'axios';
import Form from 'your-favourite-form-library';
import { Redirect } from 'react-router';

export default () => {
  const { user, setUser } = useStore();
  const login = async ({ email, password }) => {
    const { data } = await axios.post('/login', { email, password });
    setUser(user);
  };
  if (user) return <Redirect to="/user" />;
  return (
    <Form onSubmit={login}>
      Email: <input name="email" type="email" />
      Password: <input name="password" type="password" />
      <button>Send</button>
    </Form>
  );
};
```


### Loading pokemons async

Now let's load the list of pokemon asynchronously:

```js
// src/PokemonList.js
import { useStore } from 'statux';
import React, { useEffect } from 'react';
import axios from 'axios';
import { Link } from 'react-router';

const url = 'https://pokeapi.co/api/v2/pokemon/1';

export default () => {
  const { pokemon, setPokemon } = useStore();
  useEffect(() => {
    (async () => {
      const { data } = await axios.get(url);
      setPokemon(data);
    })();
  }, []);
  if (!pokemon) return 'Loading...';
  return (
    <div>
      <h2>Pokemon list:</h2>
      <ul>
        {pokemon.map(({ id, name }) => (
          <li>
            <Link to={`/${id}`}>{name}</Link>
          </li>
        ))}
      </ul>
    </div>
  );
};
```
